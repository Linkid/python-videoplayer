environment:
  global:
    # SDK v7.0 MSVC Express 2008's SetEnv.cmd script will fail if the
    # /E:ON and /V:ON options are not enabled in the batch script intepreter
    # See: http://stackoverflow.com/a/13751649/163740
    CMD_IN_ENV: "cmd /E:ON /V:ON /C .\\appveyor\\run_with_env.cmd"

    CIBW_BEFORE_BUILD: "pip install cython scikit-build cmake ninja"
    CIBW_BEFORE_BUILD_WINDOWS: "Powershell.exe -executionpolicy remotesigned -File .appveyor/before_build.ps1"
    #CIBW_BEFORE_BUILD_WINDOWS: "bash -c .appveyor/before_build.sh"
    #CIBW_BEFORE_BUILD_MACOS: "bash .appveyor/before_build.sh"
    #CIBW_BEFORE_BUILD_LINUX: "bash .appveyor/before_build.sh"
    CIBW_ENVIRONMENT_WINDOWS: "VCPKG_BUILD=1 VCPKG_TOOLCHAIN='C:/tools/vcpkg/scripts/buildsystems/vcpkg.cmake'"
    CIBW_BUILD: cp37-win*
    #CIBW_SKIP: pp*-manylinux

  matrix:
#    - APPVEYOR_BUILD_WORKER_IMAGE: Ubuntu
#      APPVEYOR_JOB_NAME: "python37-x64-ubuntu"
    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
      APPVEYOR_JOB_NAME: "python37-x64-vs2015"
#    - APPVEYOR_BUILD_WORKER_IMAGE: macos-mojave
#      APPVEYOR_JOB_NAME: "python37-x64-macos-mojave"

cache: c:\tools\vcpkg\installed\
stack: python 3.7

init:
  - cmd: set PATH=C:\Python37;C:\Python37\Scripts;%PATH%

install:
  - "%CMD_IN_ENV% python -m pip install cibuildwheel==1.3.0"

build_script:
  - "%CMD_IN_ENV% python -m cibuildwheel --output-dir wheelhouse"

artifacts:
  - path: "wheelhouse\\*.whl"
    name: Wheels
